<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Visor de Archivos Académicos (Excel)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial; margin: 30px;}
    .btn { background: #35558a; color: #fff; padding: 8px 18px; border: none; border-radius: 8px; cursor: pointer;}
    .container { background: #fafafa; border-radius: 8px; padding: 18px 28px; box-shadow: 0 0 8px #bbb; max-width: 1100px; margin: auto;}
    h2 { color: #932432; }
    table { border-collapse: collapse; width: 100%; margin: 22px 0;}
    th, td { border: 1px solid #ccc; padding: 6px;}
    th { background: #932432; color: #fff;}
    tr:nth-child(even) { background: #f7f7f7;}
    .sheet-title {font-weight:bold; color:#35558a; margin-top:18px;}
    .block {margin-top: 32px;}
  </style>
</head>
<body>
<div class="container">
  <h2>Visor de Archivos Académicos (Excel)</h2>
  <p>Sube uno o varios archivos Excel. El sistema mostrará las hojas y los datos EXACTAMENTE como están en cada archivo.</p>
  <input type="file" id="fileInput" accept=".xlsx" multiple class="btn">
  <div id="resultados"></div>
</div>
<script>
document.getElementById('fileInput').addEventListener('change', function(e){
  document.getElementById('resultados').innerHTML = "Procesando...";
  const files = e.target.files;
  let html = "";
  let filesProcessed = 0;
  for(let file of files){
    const reader = new FileReader();
    reader.onload = function(evt){
      const data = new Uint8Array(evt.target.result);
      const workbook = XLSX.read(data, {type: 'array'});
      html += `<div class='block'><h3>${file.name}</h3>`;
      workbook.SheetNames.forEach(sheetName => {
        html += `<div class="sheet-title">${sheetName}</div>`;
        const sheet = workbook.Sheets[sheetName];
        const json = XLSX.utils.sheet_to_json(sheet, {header:1});
        if(json.length>0){
          html += "<table>";
          // Encabezados
          html += "<tr>";
          json[0].forEach(h => html += `<th>${h!==undefined?h:""}</th>`);
          html += "</tr>";
          // Filas
          for(let i=1;i<json.length;i++){
            html += "<tr>";
            json[i].forEach(cell => html += `<td>${cell!==undefined?cell:""}</td>`);
            html += "</tr>";
          }
          html += "</table>";
        }
      });
      html += "</div>";
      filesProcessed++;
      if(filesProcessed === files.length) document.getElementById('resultados').innerHTML = html;
    };
    reader.readAsArrayBuffer(file);
  }
});
</script>
</body>
</html>
